(()=>{"use strict";var e={745:(e,t,n)=>{var a=n(533);t.s=a.createRoot,a.hydrateRoot},533:e=>{e.exports=ReactDOM}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=React;var t,a=n.n(e),r=n(745);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(this,arguments)}const l=function(n){return e.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},n),t||(t=e.createElement("path",{d:"M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"})))};function c(e){return a().createElement("header",null,a().createElement("div",{className:"toolbar"},a().createElement("button",{className:"icon",onClick:e.onMenuClick},a().createElement(l,null)),a().createElement("span",{className:"text-title"},"Streaker")))}function o(){const[t,n]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=null!==localStorage.getItem("ignorePersist");navigator.storage&&!e?navigator.storage.persisted().then((t=>{n(!e&&!t)})):n(!1)}),[]),a().createElement("div",null,t&&a().createElement("div",{className:"card persist"},a().createElement("div",{className:"card-content"},a().createElement("span",{className:"text-title"},"Set Persistant Storage"),a().createElement("span",{className:"text-body"},"Streaker uses IndexedDB to store data. However, IndexedDB may be cleared by the browser unless it is peristant. In order to make sure that Streaker's data isn't cleared, we need permission to store persistant data.")),a().createElement("div",{className:"card-actions"},a().createElement("button",{className:"text",onClick:function(){navigator.storage.persist().then((e=>{e&&n(!1)}))}},"Grant Permission"),a().createElement("button",{className:"text",onClick:function(){localStorage.setItem("ignorePersist","true"),n(!1)}},"Don't show again"))))}const i=Dexie;var u,d=n.n(i);function m(){const e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}!function(e){e[e.INCREMENT=0]="INCREMENT",e[e.DECREMENT=1]="DECREMENT",e[e.RESET=2]="RESET"}(u||(u={}));class p extends(d()){constructor(){super("StreakDatabase"),this.version(3).stores({streaks:"++id, name, lastUpdated"}),this.clearStreaks()}clearStreaks(){this.streaks.where("lastUpdated").below(function(){const e=new Date;return e.setDate(e.getDate()-1),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}()).toArray().then((e=>{e.forEach((e=>{this.update(e.id,u.RESET)}))}))}async update(e,t){const n=await this.streaks.get(e);if(!n)return;const a=new Date;switch(t){case u.RESET:n.currentStreak=0,n.lastUpdated>=m()&&n.lastUpdated.setDate(n.lastUpdated.getDate()-1);break;case u.INCREMENT:n.currentStreak++,n.currentStreak>n.longestStreak&&(n.longestStreak=n.currentStreak),n.lastUpdated=a;break;case u.DECREMENT:n.currentStreak--,n.currentStreak<0&&(n.currentStreak=0),a.setDate(a.getDate()-1),n.lastUpdated=a}this.streaks.update(e,n)}addEntry(e){this.streaks.put({name:e,longestStreak:0,currentStreak:0,lastUpdated:new Date(0)})}deleteEntry(e){this.streaks.delete(e)}}const E=new p,g=DexieReactHooks;var v;function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f.apply(this,arguments)}const h=function(t){return e.createElement("svg",f({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),v||(v=e.createElement("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9Z"})))};var y;function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},k.apply(this,arguments)}const N=function(t){return e.createElement("svg",k({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),y||(y=e.createElement("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4 8-8-1.41-1.42Z"})))};var w;function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},b.apply(this,arguments)}const S=function(t){return e.createElement("svg",b({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),w||(w=e.createElement("path",{d:"M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"})))};var O;function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},C.apply(this,arguments)}const x=function(t){return e.createElement("svg",C({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),O||(O=e.createElement("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z"})))};var D;function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},M.apply(this,arguments)}const j=function(t){return e.createElement("svg",M({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),D||(D=e.createElement("path",{d:"M12 5V1L7 6l5 5V7a6 6 0 0 1 6 6 6 6 0 0 1-6 6 6 6 0 0 1-6-6H4a8 8 0 0 0 8 8 8 8 0 0 0 8-8 8 8 0 0 0-8-8Z"})))};function R(e){const t=e.entry.lastUpdated>=m();return a().createElement("div",{className:"card"},a().createElement("div",{className:"card-content"},a().createElement("span",{className:"text-title"},e.entry.name),a().createElement("span",{className:"text-body"},"Current Streak: ",e.entry.currentStreak),a().createElement("span",{className:"text-body text-secondary"},"Longest Streak: ",e.entry.longestStreak)),a().createElement("div",{className:"card-actions"},a().createElement("div",{className:"flex-row grow"},a().createElement("button",{className:"icon",onClick:function(){E.update(e.entry.id,t?u.DECREMENT:u.INCREMENT)}},t?a().createElement(h,null):a().createElement(N,null)),a().createElement("button",{className:"icon",onClick:function(){E.update(e.entry.id,u.RESET)}},a().createElement(j,null))),a().createElement("div",{className:"flex-row"},a().createElement("button",{className:"icon",onClick:function(){e.openEditDialog(e.entry.id)}},a().createElement(S,null)),a().createElement("button",{className:"icon",onClick:function(){E.deleteEntry(e.entry.id)}},a().createElement(x,null)))))}var T,I;function A(e){function t(t){e.setOptions(Object.assign(Object.assign({},e.options),{order:t.target.value}))}function n(t){e.setOptions(Object.assign(Object.assign({},e.options),{ascending:"true"===t.target.value}))}return a().createElement("div",{className:"flex-column drawer-list"},a().createElement("div",{className:"card"},a().createElement("div",{className:"card-content"},a().createElement("fieldset",null,a().createElement("legend",null,"Sort By"),a().createElement("div",{className:"flex-column"},a().createElement("label",null,a().createElement("input",{type:"radio",name:"sort-order",value:T.NAME,checked:e.options.order===T.NAME,onChange:t}),"Name"),a().createElement("label",null,a().createElement("input",{type:"radio",name:"sort-order",value:T.CREATED,checked:e.options.order===T.CREATED,onChange:t}),"Created"))))),a().createElement("div",{className:"card"},a().createElement("div",{className:"card-content"},a().createElement("fieldset",null,a().createElement("legend",null,"Sort Order"),a().createElement("div",{className:"flex-column"},a().createElement("label",null,a().createElement("input",{type:"radio",name:"sort-ascending",value:"true",checked:e.options.ascending,onChange:n}),"Ascending"),a().createElement("label",null,a().createElement("input",{type:"radio",name:"sort-ascending",value:"false",checked:!e.options.ascending,onChange:n}),"Descending"))))))}function U(e){const t=(0,g.useLiveQuery)((()=>{let t="";switch(e.sortOptions.order){case T.NAME:t="name";break;case T.CREATED:t="id"}const n=E.streaks.orderBy(t);return e.sortOptions.ascending?n.toArray():n.reverse().toArray()}),[e.sortOptions]);return a().createElement("div",{className:"card-list"},null==t?void 0:t.map((t=>a().createElement("div",{className:"grow",key:t.id},a().createElement(R,{entry:t,openEditDialog:e.openEditDialog})))))}function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},L.apply(this,arguments)}!function(e){e.NAME="name",e.CREATED="created",e.MODIFIED="modified"}(T||(T={}));const P=function(t){return e.createElement("svg",L({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),I||(I=e.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2Z"})))};function B(){const[t,n]=(0,e.useState)("");return a().createElement("div",{className:"card"},a().createElement("div",{className:"card-content add-new"},a().createElement("div",{className:"flex-row"},a().createElement("input",{className:"grow",type:"text",placeholder:"New Streak",value:t,onChange:e=>n(e.target.value)}),a().createElement("button",{className:"icon",onClick:function(){0!==t.length&&(E.addEntry(t),n(""))}},a().createElement(P,null)))))}function H(e){const t="modal modal-"+e.anchor;return a().createElement("div",{className:t,"data-open":e.open,onClick:function(t){t.target===t.currentTarget&&e.onClick()},"data-type":e.type},e.children)}function Z(e){return a().createElement(H,{open:e.open,onClick:e.onClick,type:"drawer",anchor:"left"},a().createElement("div",{className:"drawer"},e.children))}function J(){const t=(0,e.useRef)(null);return a().createElement("div",{className:"card"},a().createElement("div",{className:"card-actions"},a().createElement("button",{className:"text",onClick:async function(){const e={streaks:await E.streaks.toArray()},t=document.createElement("a");t.href="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),t.download=`streaker-${(new Date).toJSON()}.json`,t.click()}},"Export"),a().createElement("button",{className:"text",onClick:function(){var e;null===(e=t.current)||void 0===e||e.click()}},"Import"),a().createElement("input",{ref:t,style:{display:"none"},type:"file",accept:"application/json, text/json, text/plain",onChange:function(e){const t=e.target.files;if(null===t||t.length<1)return;const n=new FileReader;n.addEventListener("load",(async()=>{try{const e=JSON.parse(n.result);Array.isArray(e.streaks)&&e.streaks.every((e=>function(e){return!!e&&"number"==typeof e.id&&"string"==typeof e.name&&"number"==typeof e.longestStreak&&"number"==typeof e.currentStreak&&"string"==typeof e.lastUpdated}(e)))&&(e.streaks=e.streaks.map((e=>(e.lastUpdated=new Date(e.lastUpdated),e))),await E.streaks.clear(),E.streaks.bulkPut(e.streaks))}catch(e){return}})),n.readAsText(t[0])}})))}function V(e){return a().createElement(Z,{open:e.open,onClick:e.toggleDrawer},a().createElement("button",{className:"text",onClick:e.toggleDrawer},"Close"),a().createElement(A,{options:e.options,setOptions:e.setOptions}),a().createElement(J,null))}function z(e){return a().createElement(H,{open:e.open,onClick:e.onClick,type:"dialog",anchor:"top"},a().createElement("div",{className:"dialog"},e.children))}function F(e){const t=new Date(e);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,16)}function Q(e){return a().createElement("input",{type:"datetime-local",value:F(e.value),onChange:function(t){if(""===t.target.value)return;const n=function(e){const t=new Date(e+":00.000Z");return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t}(t.target.value);e.onChange(n)}})}function _(t){const[n,r]=(0,e.useState)(""),[s,l]=(0,e.useState)(0),[c,o]=(0,e.useState)(0),[i,u]=(0,e.useState)(new Date(0)),d=(0,g.useLiveQuery)((()=>E.streaks.get(t.id)),[t.id]);return(0,e.useEffect)((()=>{var e,t,n,a;r(null!==(e=null==d?void 0:d.name)&&void 0!==e?e:""),l(null!==(t=null==d?void 0:d.currentStreak)&&void 0!==t?t:0),o(null!==(n=null==d?void 0:d.longestStreak)&&void 0!==n?n:0),u(new Date(null!==(a=null==d?void 0:d.lastUpdated)&&void 0!==a?a:0))}),[d]),a().createElement(z,{open:t.open,onClick:t.close},a().createElement("div",{className:"card-content"},a().createElement("span",{className:"text-title"},'Edit "',null==d?void 0:d.name,'"'),a().createElement("label",null,"Name",a().createElement("input",{type:"text",placeholder:"Name",value:n,onChange:e=>r(e.target.value)})),a().createElement("details",null,a().createElement("summary",null,"Advanced Options"),a().createElement("div",{className:"flex-column"},a().createElement("label",null,"Current Streak",a().createElement("input",{type:"number",min:"0",placeholder:"Current Streak",value:s,onChange:e=>l(parseInt(e.target.value))})),a().createElement("label",null,"Longest Streak",a().createElement("input",{type:"number",min:"0",placeholder:"Longest Streak",value:c,onChange:e=>o(parseInt(e.target.value))})),a().createElement("label",null,"Last Updated",a().createElement(Q,{value:i,onChange:e=>u(e)}))))),a().createElement("div",{className:"card-actions dialog-actions"},a().createElement("button",{className:"text",onClick:t.close},"Close"),a().createElement("button",{className:"text",onClick:function(){0===n.length||isNaN(s)||isNaN(c)||(E.streaks.update(t.id,{name:n,currentStreak:s,longestStreak:c,lastUpdated:i}),t.close())}},"Sumbit")))}const q={order:T.NAME,ascending:!0};(0,r.s)(document.querySelector("#app")).render(a().createElement((function(){const[t,n]=(0,e.useState)(!1);function r(){n(!t)}const[s,l]=(0,e.useState)(!1),[i,u]=(0,e.useState)(-1),[d,m]=function(t,n){const[a,r]=(0,e.useState)((()=>{const e=localStorage.getItem(t);if(null===e)return localStorage.setItem(t,JSON.stringify(n)),n;try{return JSON.parse(e)}catch(e){return localStorage.setItem(t,JSON.stringify(n)),n}}));return(0,e.useEffect)((()=>{localStorage.setItem(t,JSON.stringify(a))}),[a]),[a,r]}("sort",q);return a().createElement("div",null,a().createElement(c,{onMenuClick:r}),a().createElement("div",{className:"content"},a().createElement(V,{open:t,toggleDrawer:r,options:null!=d?d:q,setOptions:m}),a().createElement(o,null),a().createElement(B,null),a().createElement(U,{openEditDialog:function(e){u(e),l(!0)},sortOptions:null!=d?d:q}),a().createElement(_,{open:s,id:i,close:function(){l(!1)},key:i})))}),null))})()})();
//# sourceMappingURL=index.bundle.js.map